<div class="member-container">

  <div class="member-content-container">
    <div class="member-top-infos">
      <div class="member-photo-container">
        <img class="member-photo"
             src="../../../../../assets/images/default-profile.jpg"
             alt="photo de {{member.personne.prenom}}-{{member.personne.nom}}">
      </div>
      <div class="member-basic-infos">
        <h2 class="member-fullname">{{ member.personne.prenom }} {{ member.personne.nom }}</h2>
        <p class="member-since">
          Membre depuis le {{ member.dateInscription | date: 'dd/MM/yyyy' }}
          <span class="member-status">({{ member.estActif ? 'actif' : 'inactif' }})</span>
        </p>
      </div>
      <div class="member-belts-container">
        <p-chip label="jiu-jutsu" styleClass="{{jujutsuTopBelt}}"></p-chip>
        <p-chip label="taï-jutsu" styleClass="{{taijutsuTopBelt}}"></p-chip>
      </div>
    </div>

    <p-divider align="left">
      <b>Informations</b>
    </p-divider>

    <div class="member-infos-container">
      <p>
        Né le {{ member.dateNaissance | date: 'dd-MM-yyyy' }} ({{ member.dateNaissance | age }} ans)
      </p>
      <p><u>Sexe</u> : {{ member.sexe }}</p>
      <p><u>Groupe sanguin</u>: {{ member.groupeSanguin ? member.groupeSanguin: 'inconnu' }}</p>
      <p><u>Autorisation image</u> : {{ member.autoriseImage ? 'oui' : 'non' }}</p>
    </div>

    <p-divider align="left">
      <b>Contact</b>
    </p-divider>

    <div class="contact-container">

      <div class="contact-personal">
        <p><i class="pi pi-phone"></i> {{ member.personne.telephone }}</p>
        <p><i class="pi pi-envelope"></i> {{ member.personne.email }}</p>
        <p *ngIf="member.adresse">
          <i class="pi pi-map-marker"></i>
          {{ member.adresse.rue }},
          {{ member.adresse.numero }} -
          {{ member.adresse.codePostal }} {{ member.adresse.ville }}
        </p>
      </div>

      <div class="contact-others">
        <p-accordion>
          <p-accordionTab header="Contact en cas d'urgence">
            <div class="contact-contact">
              <p>
                <b>{{ member.contact.personne.prenom }} {{ member.contact.personne.nom }}</b>
                <span> ({{ member.contact.lienAvecMembre }} de l'adhérent)</span>
              </p>
              <p><i class="pi pi-phone"></i> {{ member.contact.personne.telephone }}</p>
            </div>
          </p-accordionTab>
          <p-accordionTab header="Référent légal" *ngIf="member.referent">
            <div class="contact-referent">
              <p>
                <b>{{ member.referent.personne.prenom }} {{ member.referent.personne.nom }}</b>
                <span> ({{ member.referent.lienAvecMembre }} de l'adhérent)</span>
              </p>
              <p><i class="pi pi-phone"></i> {{ member.referent.personne.telephone }}</p>
              <p><i class="pi pi-envelope"></i> {{ member.referent.personne.email }}</p>
              <p>
                <i class="pi pi-map-marker"></i>
                {{ member.referent.adresse.rue }},
                {{ member.referent.adresse.numero }} -
                {{ member.referent.adresse.codePostal }} {{ member.referent.adresse.ville }}
              </p>
            </div>
          </p-accordionTab>
        </p-accordion>
      </div>

    </div>

    <p-divider align="left">
      <b>Ceintures</b>
    </p-divider>

    <div class="grades">
      <p-dialog header="Ajouter une ceinture" [(visible)]="displayBeltModal" [modal]="true" [style]="{width: '50vw', height:'60vh'}" [draggable]="false" [resizable]="false">
        <p class="m-0">Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco
            laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur.
            Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
        </p>
        <form [formGroup]="beltForm">
          <div class="field col-6 col-offset-3">
            <div class="group-addbelt-form">
              <label for="jiujitsu">Discipline</label>
              <p-dropdown [options]="jjBelts" placeholder="Sélectionner la discipline" optionLabel="discipline" formControlName="discipline"></p-dropdown>
            </div>
            <div class="group-addbelt-form">
              <label for="jiujitsu">Ceinture</label>
              <p-dropdown [options]="jjBelts" placeholder="Sélectionner la ceinture" optionLabel="couleur" formControlName="ceinture"></p-dropdown>
            </div>
          </div>
        </form>
        <ng-template pTemplate="footer">
        <p-button icon="pi pi-check" (click)="addBelt()" label="Ok" styleClass="p-button-text"></p-button>
        </ng-template>
      </p-dialog>
      <p-table [value]="member.ceintures" responsiveLayout="scroll">
        <ng-template pTemplate="header">
            <tr>
              <th pSortableColumn="dateObtention">Date <p-sortIcon field="dateObtention"></p-sortIcon></th>
              <th pSortableColumn="discipline">Discipline<p-sortIcon field="discipline"></p-sortIcon></th>
              <th pSortableColumn="couleur">Ceinture <p-sortIcon field="couleur"></p-sortIcon></th>
            </tr>
        </ng-template>
        <ng-template pTemplate="body" let-belt>
            <tr>
              <td>{{ belt.dateObtention | date: 'dd-MM-yyyy' }}</td>
              <td>{{ belt.discipline }}</td>
              <td>{{ belt.couleur }}</td>
            </tr>
        </ng-template>
      </p-table>
    </div>

    <p-divider align="left">
      <b>Cotisations</b>
    </p-divider>

    <div class="member-cotisations">
      <p-dialog header="Ajouter une cotisation" [(visible)]="displayMembershipModal" [modal]="true" [style]="{width: '50vw'}" [draggable]="false" [resizable]="false">
        <p class="m-0">Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco
            laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur.
            Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
        </p>
        <form [formGroup]="membershipForm">
          <div class="p-fluid grid">

          </div>
        </form>
        <ng-template pTemplate="footer">
        <p-button icon="pi pi-check" (click)="addMembership()" label="Ok" styleClass="p-button-text"></p-button>
        </ng-template>
      </p-dialog>
      <p-table [value]="member.cotisations" responsiveLayout="scroll">
        <ng-template pTemplate="header">
            <tr>
              <th pSortableColumn="estArchive">Status<p-sortIcon field="estArchive"></p-sortIcon></th>
              <th pSortableColumn="estPaye">Paiement<p-sortIcon field="estPaye"></p-sortIcon></th>
              <th pSortableColumn="prix">Prix<p-sortIcon field="prix"></p-sortIcon></th>
              <th pSortableColumn="duree">Formule<p-sortIcon field="duree"></p-sortIcon></th>
              <th pSortableColumn="dateDebut">Date de souscription<p-sortIcon field="dateDebut"></p-sortIcon></th>
              <th pSortableColumn="dateFin">Echéance<p-sortIcon field="dateFin"></p-sortIcon></th>
            </tr>
        </ng-template>
        <ng-template pTemplate="body" let-cotisation>
            <tr>
              <td>{{ cotisation.estArchive ? 'Archivé' : 'Active' }}</td>
              <td>{{ cotisation.estPaye ? 'Payé' : 'En attente de paiement' }}</td>
              <td>{{ cotisation.prix }}€</td>
              <td>{{ cotisation.duree }}</td>
              <td>{{ cotisation.dateDebut | date: 'dd-MM-yyyy' }}</td>
              <td>{{ cotisation.dateFin | date: 'dd-MM-yyyy' }}</td>
            </tr>
        </ng-template>
      </p-table>
    </div>
  </div>

  <div class="member-actions-container">
    <div class="action-btns">
      &nbsp; <button [routerLink]="['./../../update/', member.idMembre]" pButton type="button" label="Modifier" class="p-button-sm"></button>
      &nbsp; <button (click)="displayAddBelt()" pButton type="button" label="Ajouter une ceinture" class="p-button-sm"></button>
      &nbsp; <button (click)="displayAddMembership()" pButton type="button" label="Ajouter une cotisation" class="p-button-sm"></button>
      &nbsp; <button (click)="deleteMember()" pButton type="button" label="Désactiver" class="p-button-sm"></button>
    </div>
  </div>
</div>
